<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>素数ゲーム</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        #question { font-size: 24px; margin-bottom: 10px; }
    </style>
</head>
<body>

<h2>素数判定ゲーム（全10問）</h2>
<div id="question"></div>

<button onclick="answer(true)">素数！</button>
<button onclick="answer(false)">素数じゃない！</button>

<div id="status"></div>

<script>
const results = [];
let current = 0;
let number = 0;

function isPrime(n) {
    if (n < 2) return false;
    for (let i = 2; i * i <= n; i++) {
        if (n % i === 0) return false;
    }
    return true;
}

function newQuestion() {
    number = Math.floor(Math.random() * 200) + 2;
    document.getElementById("question").innerText =
        `Q${current + 1}: ${number} は素数？`;
}

function answer(userAnswer) {
    const correct = isPrime(number);

    results.push({
        number: number,
        prime: correct,
        user: userAnswer,
        ok: correct === userAnswer
    });

    current++;

    if (current >= 10) {
        finishGame();
    } else {
        newQuestion();
    }
}

function finishGame() {
    document.getElementById("question").innerText = "終了！結果送信中…";
    document.getElementById("status").innerText = "";

    fetch(
        "https://script.google.com/macros/s/AKfycbxYPIFh5xpkeLuwWblW5JBRdr0erZzGASGelnQHgiBCOyWOtHsQut_GKw2XKiZhyxNogw/exec",
        {
            method: "POST",
            body: JSON.stringify(results)
        }
    )
    .then(r => r.text())
    .then(txt => {
        document.getElementById("status").innerText = "送信完了！";
    })
    .catch(err => {
        document.getElementById("status").innerText = "送信失敗：" + err;
    });
}

newQuestion();
</script>

</body>
</html>
